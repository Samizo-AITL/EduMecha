# PIDパラメータ設定 - ジンバル制御（Yaw／Pitch軸）

## 概要
このドキュメントでは、2軸ジンバル（Yaw軸／Pitch軸）の姿勢制御に用いるPIDパラメータを定義し、調整方法と設計意図を明示します。

各軸に対して個別のゲイン設定を行い、IMU（姿勢センサ）による出力を安定化させることが目的です。

---

## PID制御式（標準形）

$$
u(t) = K_p \cdot e(t) + K_i \cdot \int e(t) \, dt + K_d \cdot \frac{de(t)}{dt}
$$

ここで：

- $u(t)$：制御出力（サーボ指令）  
- $e(t)$：目標角度と現在角度の誤差  
- $K_p$：比例ゲイン  
- $K_i$：積分ゲイン  
- $K_d$：微分ゲイン  

---

## Yaw軸パラメータ（外枠）

| 項目       | 値（初期設定） | 備考                         |
|------------|----------------|------------------------------|
| `Kp_yaw`   | 1.5            | 誤差に対する追従速度        |
| `Ki_yaw`   | 0.05           | バイアス補正（わずかに使用）|
| `Kd_yaw`   | 0.2            | 外乱に対する応答性          |
| `備考`     | -              | 惰性が大きいため、緩やかな設定 |

---

## Pitch軸パラメータ（内枠）

| 項目        | 値（初期設定） | 備考                        |
|-------------|----------------|-----------------------------|
| `Kp_pitch`  | 2.0            | 反応性を高めるためやや強め |
| `Ki_pitch`  | 0.1            | 重心変化への長期補正       |
| `Kd_pitch`  | 0.25           | 微振動抑制のため強め       |
| `備考`      | -              | 軽量構造なので過制動に注意 |

---

## 調整ステップ（推奨）

1. **$K_p$ のみ設定** → 応答性とオーバーシュートの観察  
2. **$K_d$ 追加** → 振動抑制と立ち上がり制御  
3. **$K_i$ 調整** → 定常偏差がある場合のみ徐々に上げる  
4. **IMUプロット確認** → `imu_response_plot.png` で可視化  

---

## 注意点
- Yaw軸とPitch軸で慣性・重心・トルクが異なるため、別個に調整が必要  
- IMUノイズや遅延も考慮して、フィルタとの組み合わせも検討可  

---

## 関連ファイル
- `fsm.yaml`：PIDのON/OFF切り替えトリガ  
- `state_log.md`：状態遷移中のPID応答ログ  
- `imu_response_plot.png`：実測プロット（Python可視化）  

---

著作：三溝真一（Samizo-AITL）  
ライセンス：MIT（教育・PoC再利用可）
